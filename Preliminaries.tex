\section{Category-theoretic preliminaries}

\subsection{Higher categorical terminology pedantry}
We will speak frequently of category-valued presheaves (i.e., contravariant functors into the category of categories) and natural transformations between these. Technically, what we mean by these are not \quote{functors} and \quote{natural transformations} in the traditional sense, but what some call "pseudofunctors" and \quote{pseudonatural transformations}, or \quote{2-functors} and \quote{2-natural transformations}, as the category of categories should be viewed as a 2-category, lacking a notion of equality between its 1-cells and only having a notion of isomorphism between them instead. That is, wherever one might traditionally ask for an (automatically coherent) system of equalities, this is replaced by a coherent system of isomorphisms. We take the convention that this is what terminology such as \quote{functor} and \quote{natural transformation} already means, in such a context. But we will try our best to construct arguments in such a way as that this is mostly not a bother that needs to be explicitly worried about.

Similarly, if we ever describe diagrams involving functors between categories as commuting, we really mean that these diagrams commute up to natural isomorphism. If we make claims about uniqueness in such a context, we mean the space of choices is contractible up to the relevant isomorphisms. And so on. Again, our convention is that this is what such terminology already means, in any categorical context where one has such concepts of isomorphism around, unless we have taken care to say we are working with stricter notions instead (see more on strictness below).

\subsection{Indexed, \repsmall/, and locally \repsmall/ structures}
We assume familiarity with sets, functions, categories, functors, categories having finite limits (also known as lexcategories), functors preserving finite limits (also known as lexfunctors), natural transformations, presheaves, internal categories, etc, all in the ordinary sense.

We will take all categories to be locally small (which is to say, we will take $\Set$ to be large enough to include the hom-set between any two objects of any category we work with). Generally speaking, we are interested in the categories we work with being small as well, except for those particular large categories such as $\Set$, $\Set^X$, $\Cat$, etc, but wherever this is important we will make some explicit note.

We will now give a series of related definitions. The notions being described in this section are all relatively old hat, none of them are newly invented by us, but we wish to pin them down with particular names for our purposes. Some of them lack standard names, and in other cases we are using a new name with different connotations than the standard name. The purpose of these definitions is to establish a convenient and useful vocabulary for easily talking about the things we wish to talk about in the rest of this document.

\UnprintedTODO{Clean this up by removing any definitions we don't end up using often.}

The key notion upon which everything else builds is the following:

\begin{definition}
Let $T$ be an arbitrary category. By a $T$-\defined{indexed set}, we mean a presheaf on $T$; that is, a contravariant functor from $T$ to $\Set$. By a \defined{function} or \defined{map} or any such thing between $T$-indexed sets, we mean a natural transformation between the corresponding presheaves.
\end{definition}

The category of $T$-indexed sets and maps between them is thus the presheaf category $\Set^{\op{T}}$. We may also refer to this as $\Psh{T}$.

We may refer to the data of an indexed set at any object $t$ of the category over which it is indexed as its data \defined{defined over} $t$, or which is $t$-\defined{indexed}, or as its $t$-\defined{aspect}. Note that data defined over $t$ is automatically transferred to corresponding data defined over $s$ by any morphism from $s$ to $t$ in $T$, by the action of the presheaf. In contexts where it would cause no confusion to speak in this way, we use the same name of the data over $t$ again for the corresponding data over $s$, especially when $t$ is a terminal object.

In the particular case where $t$ is a terminal object, we may refer to the aspect at $t$ of an indexed set as its \defined{global aspect}. By the Yoneda lemma, this global aspect data $P(1)$ of a presheaf $P$ on category $T$ is the same as the data of a map from the terminal object $1$ to $P$, which is the same as the data of a map from the constantly $1$ presheaf to $P$. This is also the same as the data of the limit of $P$, thought of a $\op{T}$-indexed diagram. In this way, even if $T$ does not have a terminal object, we may still speak of the global aspect of $T$-indexed sets.

\begin{definition}
We say an indexed set is \defined{\repsmall/} (or $T$-\repsmall/, when we wish to emphasize which indexing category we are talking about) if the corresponding presheaf is representable. \TODOinline{I am in the middle of changing instances of "small" in this document to "\repsmall/". They have not all changed yet, so you will see the word \quote{small} still used in much of the document to mean \repsmall/. Also, cf. definition 7.3.3 in Bart Jacobs for analogous terminology.}
\end{definition}

(It is perhaps a bit misleading to use \quote{small}-derived terminology here, as this notion is not closed under subobjects. Indeed, what might be considered the smallest indexed set, the one which constantly takes the value of the empty set, is never \repsmall/ in this technical representability sense. But the analogy to the familiar distinction between \quote{small} sets and non-\quote{small} proper classes is often a fruitful one, motivating this terminology. When the indexing category $T$ has finite limits (or even just splittings of idempotents), this notion of \repsmall/ is equivalent to the standard notion \quote{tiny}; see \url{https://ncatlab.org/nlab/show/tiny+object#in_presheaf_categories}.)

\begin{convention}
Via the Yoneda embedding (which we denote $\yoneda$), we identify $T$ itself as the full subcategory of \repsmall/ $T$-indexed sets within the category of all $T$-indexed sets. In this way, we may speak, for example, of functions from objects of $T$ to $T$-indexed sets. That is, when $t$ is an object of $T$, we will readily write $t$ also to mean the Yoneda embedding of $t$, when we wish to treat it as a \repsmall/ $T$-indexed set; we will usually not explicitly write $\yoneda(t)$.
\end{convention}

\begin{theorem}
Note that \repsmall/ sets are closed under any limits which exist in $T$. In particular, if $T$ is a lexcategory, \repsmall/ sets are closed under finite limits. (This is essentially the observation that the Yoneda lemma preserves limits.)
\end{theorem}

\begin{definition}
Note that given an arbitrary functor $f : S \to T$, this induces by composition a functor $\pullAlong{f}$ from $T$-indexed sets to $S$-indexed sets.

That is, from a $T$-indexed set $P$, we may construct the following $S$-indexed set $\pullAlong{f} P$:

% https://q.uiver.app/?q=WzAsMyxbMCwwLCJcXG9we1N9Il0sWzIsMCwiXFxvcHtUfSJdLFs0LDAsIlxcU2V0Il0sWzAsMSwiXFxvcHtmfSJdLFsxLDIsIlAiXV0=
\[\begin{tikzcd}
	{\op{S}} && {\op{T}} && \Set
	\arrow["{\op{f}}", from=1-1, to=1-3]
	\arrow["P", from=1-3, to=1-5]
\end{tikzcd}\]
\end{definition}

\begin{theorem}\label{YonedaPullalong}
Given $f : S \to T$ and an object $s$ in $S$ and a $T$-indexed set $P$, we have that $\Hom(s, \pullAlong{f}P) = \Hom(f(s), P)$, with this correspondence being natural in both $s$ and $P$.
\end{theorem}
\begin{proof}
Keep in mind that in these \quote{Hom}s, $s$ and $f(s)$ have implicitly been construed as $S$-indexed sets via the Yoneda embedding, so we can apply the Yoneda lemma to both sides of the equation to reduce it to $(\pullAlong{f}P)(s) = P(f(s))$, which is the definition of $\pullAlong{f}$.

This completes the proof. (In fancy categorical jargon, we have demonstrated that $\yoneda \circ f : S \to \Psh{T}$ is the relative left adjoint of $\pullAlong{f} : \Psh{T} \to \Psh{S}$, relative to the Yoneda embedding $\yoneda : S \to \Psh{S}$. Equivalently, we have demonstrated that left Kan extension along $f$ takes representable functors to representable functors by application of $f$ on their representing objects.)
\end{proof}

\begin{corollary}\label{YonedaPullalongLemma}
Given $f$, $s$, and $P$ as in \cref{YonedaPullalong}, we have that every morphism $m : s \to \pullAlong{f} P$ factors through a morphism in the range of $\pullAlong{f}$. That is, $m = \pullAlong{f}(m') \circ \eta$ for some $m' : f(s) \to P$ and $\eta : s \to \pullAlong{f}(f(s))$.
\end{corollary}
\begin{proof}
This is corollary to \cref{YonedaPullalong} by the general yoga of relative adjoints.

Specifically, consider the following naturality diagram for the correspondence in \cref{YonedaPullalong}, where $m'$ is the morphism in $\Hom(f(s), P)$ corresponding to $m \in \Hom(s, \pullAlong{f}P)$ and $\eta$ is the morphism in $\Hom(s, \pullAlong{f}f(s))$ corresponding to $\id_{f(s)} \in \Hom(f(s), f(s))$.

% https://q.uiver.app/?q=WzAsOCxbMCwwLCJcXEhvbShmKHMpLCBmKHMpKSJdLFszLDAsIlxcSG9tKGYocyksIFApIl0sWzAsMywiXFxIb20ocywgXFxwdWxsQWxvbmd7Zn1mKHMpKSJdLFszLDMsIlxcSG9tKHMsIFxccHVsbEFsb25ne2Z9UCkiXSxbMSwxLCJcXGlkX3tmKHMpfSJdLFsyLDEsIm0nIl0sWzEsMiwiXFxldGEiXSxbMiwyLCJcXHB1bGxBbG9uZ3tmfShtJykgXFxjaXJjIFxcZXRhID0gbSJdLFswLDEsIm0nIFxcY2lyYyAtIl0sWzIsMywiXFxwdWxsQWxvbmd7Zn0obScpIFxcY2lyYyAtIl0sWzIsMCwiIiwxLHsibGV2ZWwiOjIsInN0eWxlIjp7ImhlYWQiOnsibmFtZSI6Im5vbmUifX19XSxbMywxLCIiLDEseyJsZXZlbCI6Miwic3R5bGUiOnsiaGVhZCI6eyJuYW1lIjoibm9uZSJ9fX1dLFs0LDUsIiIsMSx7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Im1hcHMgdG8ifX19XSxbNCw2LCIiLDEseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJtYXBzIHRvIn19fV0sWzYsNywiIiwxLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoibWFwcyB0byJ9fX1dLFs1LDcsIiIsMSx7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Im1hcHMgdG8ifX19XV0=
\[\begin{tikzcd}
	{\Hom(f(s), f(s))} &&& {\Hom(f(s), P)} \\
	& {\id_{f(s)}} & {m'} \\
	& \eta & {\pullAlong{f}(m') \circ \eta = m} \\
	{\Hom(s, \pullAlong{f}f(s))} &&& {\Hom(s, \pullAlong{f}P)}
	\arrow["{m' \circ -}", from=1-1, to=1-4]
	\arrow["{\pullAlong{f}(m') \circ -}", from=4-1, to=4-4]
	\arrow[Rightarrow, no head, from=4-1, to=1-1]
	\arrow[Rightarrow, no head, from=4-4, to=1-4]
	\arrow[maps to, from=2-2, to=2-3]
	\arrow[maps to, from=2-2, to=3-2]
	\arrow[maps to, from=3-2, to=3-3]
	\arrow[maps to, from=2-3, to=3-3]
\end{tikzcd}\]
\end{proof}

\begin{theorem}\label{AspectIsSliceGlobal}
Let $\Sigma$ be the forgetful functor from a slice category $T/t$ to its ambient category $T$. Then the $t$-aspect of a $T$-indexed set $P$ is in correspondence with the global aspect of $\pullAlong{\Sigma} P$.
\end{theorem}
\begin{proof}
This is corollary to \cref{YonedaPullalong}, which tells us $\Hom_{\Psh{T/t}}(1_{T/t}, \pullAlong{\Sigma} P)$ is in correspondence with $\Hom_{\Psh{T}}(\Sigma 1_{T/t}, P)$, where $1_{T/t}$ is the terminal object in $T/t$. As this terminal object is given by the identity morphism into $t$, we have that $\Sigma 1_{T/t} = t$. Thus, this equation is telling us that the global aspect of $\pullAlong{\Sigma} P$ corresponds to the $t$-aspect of $P$, as desired.
\end{proof}

\begin{theorem}\label{RepsmallRightAdjoint}
If $f$ has a right adjoint $g$, then $\pullAlong{f}$ takes \repsmall/ sets to \repsmall/ sets. Specifically, $\pullAlong{f}(t) = g(t)$.
\end{theorem}
\begin{proof}
$\pullAlong{f}$ takes any representable presheaf with representing object $t$ in $T$ to the representable presheaf $\Hom_T(f(-), t) = \Hom_S(-, g(t))$.
\end{proof}

\begin{theorem}\label{PullalongIsLex}
Any functor of the form $\pullAlong{f}$ preserves finite limits.
\end{theorem}
\begin{proof}
This can be seen in several ways. Perhaps most familiarly, this can be seen from the fact that (co)limits in a a functor category are computed pointwise where the pointwise (co)limits exist, and of course set-sized (co)limits all exist in $\Set$. Secondly, when the domain of $f$ is a small category, it can be seen from the fact that $\pullAlong{f}$ has left and right adjoints, known as left and right Kan extension, so that $\pullAlong{f}$ in fact preserves ALL (co)limits that happen to exist, regardless of size. We can also note that $\pullAlong{f}(P) = \Hom(f(-), P)$, which is manifestly limit preserving (though this argument does not generalize as easily to colimit-preservation).
\end{proof}

We also define more generally the concept of a function between indexed sets having \repsmall/ fibers:
\begin{definition}\label{RepsmallFibersDefn}
A function $f : A \to B$ between $T$-indexed sets has \defined{\repsmall/ fibers} if the pullback of $f$ along any map into $B$ from a \repsmall/ set is itself \repsmall/ (thus, lives within a slice category of $T$). That is, we say $f$ has \repsmall/ fibers just in case for every pullback diagram of the following sort within the category of $T$-indexed sets, if $t$ is \repsmall/, then so is $s$:

% https://q.uiver.app/?q=WzAsNCxbMSwwLCJBIl0sWzEsMSwiQiJdLFswLDAsInMiXSxbMCwxLCJ0Il0sWzAsMSwiZiJdLFsyLDBdLFsyLDNdLFszLDFdLFsyLDEsIiIsMix7InN0eWxlIjp7Im5hbWUiOiJjb3JuZXIifX1dXQ==
\[\begin{tikzcd}
	s & A \\
	t & B
	\arrow["f", from=1-2, to=2-2]
	\arrow[from=1-1, to=1-2]
	\arrow[from=1-1, to=2-1]
	\arrow[from=2-1, to=2-2]
	\arrow["\lrcorner"{anchor=center, pos=0.125}, draw=none, from=1-1, to=2-2]
\end{tikzcd}\]
\end{definition}

(Beware that, though this notion can be used regardless, it is best behaved when $T$ has finite limits. When $T$ does not have finite limits, this definition does not have the properties which might be expected. In particular, we might expect that any morphism between $T$-\repsmall/ sets should have $T$-\repsmall/ fibers, which would not be true if $T$ itself did not have pullbacks. If $T$ does not have binary products, it will not even be true that a map into the terminal object $1$ has \repsmall/ fibers whenever its domain is \repsmall/.)

The following two theorems follow from the composition of pullback squares into larger pullback squares (or pullback rectangles, one might say):

\begin{theorem}
Maps with \repsmall/ fibers are closed under composition.
\end{theorem}
\begin{proof}
% https://q.uiver.app/?q=WzAsNixbMSwwLCJBIl0sWzEsMSwiQiJdLFswLDAsInMiXSxbMCwxLCJ0Il0sWzEsMiwiQyJdLFswLDIsInUiXSxbMCwxLCJmIl0sWzIsMF0sWzIsM10sWzMsMV0sWzIsMSwiIiwyLHsic3R5bGUiOnsibmFtZSI6ImNvcm5lciJ9fV0sWzEsNCwiZyJdLFszLDVdLFs1LDRdLFszLDQsIiIsMSx7InN0eWxlIjp7Im5hbWUiOiJjb3JuZXIifX1dXQ==
\[\begin{tikzcd}
	s & A \\
	t & B \\
	u & C
	\arrow["f", from=1-2, to=2-2]
	\arrow[from=1-1, to=1-2]
	\arrow[from=1-1, to=2-1]
	\arrow[from=2-1, to=2-2]
	\arrow["\lrcorner"{anchor=center, pos=0.125}, draw=none, from=1-1, to=2-2]
	\arrow["g", from=2-2, to=3-2]
	\arrow[from=2-1, to=3-1]
	\arrow[from=3-1, to=3-2]
	\arrow["\lrcorner"{anchor=center, pos=0.125}, draw=none, from=2-1, to=3-2]
\end{tikzcd}\]

When we presume $g$ to have \repsmall/ fibers, we find that $t$ is \repsmall/. Then when we presume $f$ to have \repsmall/ fibers, we find that $s$ is \repsmall/. The composition of the individual pullback squares yields a pullback rectangle, which allows us to conclude that the composition $g \circ f$ has \repsmall/ fibers.

The above illustrates the argument for binary composition, by simply composing pullbacks. The argument for $n$-ary composition for any finite $n$ works inductively in the same way (note that the base $0$-ary case works in the same way as well; the pullback of an identity morphism is an identity morphism, and an identity morphism with small codomain has small domain).
\end{proof}

\begin{theorem}
Maps with \repsmall/ fibers are closed under pullback along arbitrary maps.
\end{theorem}
\begin{proof}
% https://q.uiver.app/?q=WzAsNixbMiwwLCJBIl0sWzIsMSwiQiJdLFsxLDAsIkQiXSxbMSwxLCJDIl0sWzAsMSwidCJdLFswLDAsInMiXSxbMCwxLCJmIl0sWzIsMF0sWzIsMywiZiciXSxbMywxXSxbMiwxLCIiLDIseyJzdHlsZSI6eyJuYW1lIjoiY29ybmVyIn19XSxbNCwzXSxbNSw0XSxbNSwyXSxbNSwzLCIiLDAseyJzdHlsZSI6eyJuYW1lIjoiY29ybmVyIn19XV0=
\[\begin{tikzcd}
	s & D & A \\
	t & C & B
	\arrow["f", from=1-3, to=2-3]
	\arrow[from=1-2, to=1-3]
	\arrow["{f'}", from=1-2, to=2-2]
	\arrow[from=2-2, to=2-3]
	\arrow["\lrcorner"{anchor=center, pos=0.125}, draw=none, from=1-2, to=2-3]
	\arrow[from=2-1, to=2-2]
	\arrow[from=1-1, to=2-1]
	\arrow[from=1-1, to=1-2]
	\arrow["\lrcorner"{anchor=center, pos=0.125}, draw=none, from=1-1, to=2-2]
\end{tikzcd}\]

Any pullback of $f'$ (along some arbitrary map) is a pullback of $f$ itself (along an extended map with the same domain). Thus, if $f$ has yields \repsmall/ objects whenever pulled back along a map with \repsmall/ domain, so does its pullback $f'$.
\end{proof}

\begin{theorem}\label{RepSmallRightAdjointFibers}
If $L : Q \to T$ is a functor with a right adjoint, on a category $Q$ with pullbacks, and $f$ is a map between $T$-indexed sets with $T$-\repsmall/ fibers, then $\pullAlong{L} f$ has $Q$-\repsmall/ fibers.
\end{theorem}
\begin{proof}
Let us say $f: A \to B$, and let an arbitrary map $m : q \to \pullAlong{L}(B)$ be given, where $q$ is an object of $Q$. We must show that the pullback of $\pullAlong{L} f$ along $m$ also lies within $Q$. For sake of a name, let us call the domain of this pullback $P$.

% https://q.uiver.app/?q=WzAsNCxbMSwwLCJcXHB1bGxBbG9uZ3tMfUEiXSxbMSwxLCJcXHB1bGxBbG9uZ3tMfUIiXSxbMCwxLCJxIl0sWzAsMCwiUCJdLFswLDEsIlxccHVsbEFsb25ne0x9ZiJdLFszLDJdLFsyLDEsIm0iLDJdLFszLDBdLFszLDEsIiIsMSx7InN0eWxlIjp7Im5hbWUiOiJjb3JuZXIifX1dXQ==
\[\begin{tikzcd}
	P & {\pullAlong{L}A} \\
	q & {\pullAlong{L}B}
	\arrow["{\pullAlong{L}f}", from=1-2, to=2-2]
	\arrow[from=1-1, to=2-1]
	\arrow["m"', from=2-1, to=2-2]
	\arrow[from=1-1, to=1-2]
	\arrow["\lrcorner"{anchor=center, pos=0.125}, draw=none, from=1-1, to=2-2]
\end{tikzcd}\]

First, observe via \cref{YonedaPullalongLemma} that $m$ factors as $\pullAlong{L}(m') \circ \eta$ for some $m' : L(q) \to B$ and $\eta : q \to \pullAlong{L}L(q)$.

% https://q.uiver.app/?q=WzAsMyxbMiwwLCJcXHB1bGxBbG9uZ3tMfUIiXSxbMSwwLCJcXHB1bGxBbG9uZ3tMfUwocSkiXSxbMCwwLCJxIl0sWzEsMCwiXFxwdWxsQWxvbmd7TH0gbSciLDJdLFsyLDEsIlxcZXRhIiwyXSxbMiwwLCJtIiwxLHsib2Zmc2V0Ijo1LCJjdXJ2ZSI6Mn1dLFsxLDUsIiIsMSx7InNob3J0ZW4iOnsidGFyZ2V0IjoyMH0sInN0eWxlIjp7ImhlYWQiOnsibmFtZSI6Im5vbmUifX19XV0=
\[\begin{tikzcd}
	q & {\pullAlong{L}L(q)} & {\pullAlong{L}B}
	\arrow["{\pullAlong{L} m'}"', from=1-2, to=1-3]
	\arrow["\eta"', from=1-1, to=1-2]
	\arrow[""{name=0, anchor=center, inner sep=0}, "m"{description}, shift right=5, curve={height=12pt}, from=1-1, to=1-3]
	\arrow[shorten >=2pt, Rightarrow, no head, from=1-2, to=0]
\end{tikzcd}\]

Thus, the pullback yielding $P$ we are interested in can be decomposed as follows:

% https://q.uiver.app/?q=WzAsNixbMiwwLCJcXHB1bGxBbG9uZ3tMfUEiXSxbMiwxLCJcXHB1bGxBbG9uZ3tMfUIiXSxbMSwxLCJcXHB1bGxBbG9uZ3tMfUwocSkiXSxbMSwwLCJcXHB1bGxBbG9uZ3tMfShBIFxcdGltZXNfe0J9IEwocSkpIl0sWzAsMSwicSJdLFswLDAsIlAiXSxbMCwxLCJcXHB1bGxBbG9uZ3tMfWYiXSxbMiwxLCJcXHB1bGxBbG9uZ3tMfSBtJyIsMl0sWzMsMF0sWzQsMiwiXFxldGEiLDJdLFs1LDNdLFs1LDRdLFszLDJdLFs0LDEsIm0iLDEseyJvZmZzZXQiOjUsImN1cnZlIjoyfV0sWzIsMTMsIiIsMSx7InNob3J0ZW4iOnsidGFyZ2V0IjoyMH0sInN0eWxlIjp7ImhlYWQiOnsibmFtZSI6Im5vbmUifX19XSxbNSw5LCIiLDEseyJsZXZlbCI6MSwic3R5bGUiOnsibmFtZSI6ImNvcm5lciJ9fV0sWzMsNywiIiwxLHsibGV2ZWwiOjEsInN0eWxlIjp7Im5hbWUiOiJjb3JuZXIifX1dXQ==
\[\begin{tikzcd}
	P & {\pullAlong{L}(A \times_{B} L(q))} & {\pullAlong{L}A} \\
	q & {\pullAlong{L}L(q)} & {\pullAlong{L}B}
	\arrow["{\pullAlong{L}f}", from=1-3, to=2-3]
	\arrow[""{name=0, anchor=center, inner sep=0}, "{\pullAlong{L} m'}"', from=2-2, to=2-3]
	\arrow[from=1-2, to=1-3]
	\arrow[""{name=1, anchor=center, inner sep=0}, "\eta"', from=2-1, to=2-2]
	\arrow[from=1-1, to=1-2]
	\arrow[from=1-1, to=2-1]
	\arrow[from=1-2, to=2-2]
	\arrow[""{name=2, anchor=center, inner sep=0}, "m"{description}, shift right=5, curve={height=12pt}, from=2-1, to=2-3]
	\arrow[shorten >=2pt, Rightarrow, no head, from=2-2, to=2]
	\arrow["\lrcorner"{anchor=center, pos=0.125}, draw=none, from=1-1, to=1]
	\arrow["\lrcorner"{anchor=center, pos=0.125}, draw=none, from=1-2, to=0]
\end{tikzcd}\]

The right half of the above diagram is $\pullAlong{L}$ (known to preserve pullbacks by \cref{PullalongIsLex}) applied to the following pullback diagram in $\Psh{T}$:

% https://q.uiver.app/?q=WzAsNCxbMSwwLCJBIl0sWzEsMSwiQiJdLFswLDEsIkwocSkiXSxbMCwwLCJBIFxcdGltZXNfe0J9IEwocSkiXSxbMCwxLCJmIl0sWzIsMSwibSciLDJdLFszLDJdLFszLDBdLFszLDUsIiIsMCx7ImxldmVsIjoxLCJzdHlsZSI6eyJuYW1lIjoiY29ybmVyIn19XV0=
\[\begin{tikzcd}
	{A \times_{B} L(q)} & A \\
	{L(q)} & B
	\arrow["f", from=1-2, to=2-2]
	\arrow[""{name=0, anchor=center, inner sep=0}, "{m'}"', from=2-1, to=2-2]
	\arrow[from=1-1, to=2-1]
	\arrow[from=1-1, to=1-2]
	\arrow["\lrcorner"{anchor=center, pos=0.125}, draw=none, from=1-1, to=0]
\end{tikzcd}\]

Note that, as $f$ has $T$-\repsmall/ fibers and $L(q)$ is an object of $T$ (i.e., $T$-\repsmall/), we find that $A \times_{B} L(q)$ is also $T$-\repsmall/.

By \cref{RepsmallRightAdjoint}, it follows that $\pullAlong{L}(A \times_{B} L(q))$ is $Q$-\repsmall/, as is $\pullAlong{L}L(q)$.

Thus, the left half of our above diagram is a pullback of morphisms within $Q$:

% https://q.uiver.app/?q=WzAsNCxbMSwxLCJcXHB1bGxBbG9uZ3tMfUwocSkiXSxbMSwwLCJcXHB1bGxBbG9uZ3tMfShBIFxcdGltZXNfe0J9IEwocSkpIl0sWzAsMSwicSJdLFswLDAsIlAiXSxbMiwwLCJcXGV0YSIsMl0sWzMsMV0sWzMsMl0sWzEsMF0sWzMsNCwiIiwxLHsibGV2ZWwiOjEsInN0eWxlIjp7Im5hbWUiOiJjb3JuZXIifX1dXQ==
\[\begin{tikzcd}
	P & {\pullAlong{L}(A \times_{B} L(q))} \\
	q & {\pullAlong{L}L(q)}
	\arrow[""{name=0, anchor=center, inner sep=0}, "\eta"', from=2-1, to=2-2]
	\arrow[from=1-1, to=1-2]
	\arrow[from=1-1, to=2-1]
	\arrow[from=1-2, to=2-2]
	\arrow["\lrcorner"{anchor=center, pos=0.125}, draw=none, from=1-1, to=0]
\end{tikzcd}\]

As $Q$ is closed under pullbacks, it follows that $P$ is $Q$-\repsmall/, completing our proof.
\end{proof}

\begin{definition}\label{IndexedStructuresDefn}
We can talk about any kind of $T$-indexed structure or $T$-indexed maps between such structures, as the appropriate diagram of $T$-indexed sets and functions. For example, we can talk about $T$-indexed groups and group homomorphisms between them. When the $T$-indexed sets involved (the sorts within the structure, including the domains and codomains of all the maps defining the structure) are all \repsmall/, we say the entire structure is \defined{\repsmall/}, or equivalently, we say it is \defined{internal} to $T$\footnote{This \quote{$T$-internal gadgets} terminology makes most sense when $T$ is thought of as a kind of structure such that structure-preserving maps from $T$ to $S$ take $T$-internal gadgets to $S$-internal gadgets. Thus, if the definition of gadgets invokes maps whose domains are defined using finite limits, we will use this terminology of $T$-internal gadgets only in contexts where we are taking $T$ as a category with finite limits (for example, when speaking of internal categories). If the definiton of gadgets invokes maps whose domains are defined using finite products, we will use this terminology of $T$-internal gadgets only in contexts where we are taking $T$ as a category with finite products (for example, when speaking of internal groups). If the definition of gadgets invokes maps whose domains are defined using countably infinite products, then to speak of $T$-internal gadgets, $T$ must be carrying countably infinite product structure, etc.}. By the Yoneda lemma, this amounts to a diagram of objects and morphisms within $T$ itself.
\end{definition}

Observe that, as $\pullAlong{f}$ for an arbitrary functor $f : S \to T$ preserves finite limits (by \cref{PullalongIsLex}), it not only takes $T$-indexed sets to $S$-indexed sets but also acts as a functor from $T$-indexed structures to $S$-indexed structures more generally, for any notion of structure definable using finite limits. For example, $\pullAlong{f}$ takes $T$-indexed groups to $S$-indexed groups, and so on. Furthermore, by \cref{RepsmallRightAdjoint}, if $f$ has a right adjoint, then $\pullAlong{f}$ will take \repsmall/ structures to \repsmall/ structures.

\subsection{Indexed categories}
\begin{definition}
In the same vein as all this, by a $T$-\defined{indexed category}, we mean a category-valued presheaf on $T$; that is, a contravariant functor from $T$ to $\Cat$, and by a \defined{functor} between $T$-indexed categories, we mean a natural transformation between such presheaves.\footnote{The machinery of indexed categories is equivalent to the machinery of fibered categories, a presentation some prefer, but we refrain from that presentation for now.}. (In keeping with our convention from above, note that \quote{functor} and \quote{natural transformation} here really refer to pseudofunctors and pseudonatural transformations, respectively, as $\Cat$ is a 2-category). We say this indexed category is an \defined{indexed lexcategory} (aka, \defined{has finite limits}) if this presheaf factors through the inclusion of $\LexCat$ into $\Cat$; that is, if it takes every object to a lexcategory and every morphism to a lexfunctor. We say a functor between indexed lexcategories \defined{preserves finite limits} if it arises from a natural transformation between the corresponding $\LexCat$-valued presheaves. And in the same way as all this, we can speak of \defined{natural transformations} between functors between indexed categories, or any other familiar categorical structure or property.
\end{definition}

One might have thought our definition of $T$-indexed category-like structures would simply be a special case of our previous definition of $T$-indexed set-like structures as suitable diagrams within $\Psh{T}$ (that is, as suitable diagrams of $\Set$-valued functors). However, the fact that we take indexed categories to be given by pseudofunctors into the 2-category $\Cat$, instead of treating $\Cat$ as a 1-category, provides a subtle but technically convenient generalization beyond directly demanding mere diagrams of $\Set$-valued functors.

We now might like to speak about a category being \repsmall/, in the sense that its collection of objects and its collection of morphisms are both \repsmall/, but there is one pitfall to be aware of here, related to the just mentioned subtlety. We generally speak about categories in such a way as that they do not come with a particular notion of their set of objects, as such. That is, two categories may be equivalent (in the technical sense of \quote{equivalent} within the 2-category $\Cat$) though presented with different ostensible sets of objects. For example, a category presented as comprised of one terminal object, and a category presented as comprised of two isomorphic terminal objects, are equivalent categories; there is no pseudofunctor from the 2-category of categories, functors, and natural isomorphisms to $\Set$ which would send the first of these to a one-element set and the second to a two-element set. We are to treat them as the \quote{same} category. So to speak about a category as having a particular set of objects, we must imagine it as carrying more fine-grained equality structure on its objects than we normally do.

\subsubsection{Strict categories}
These bothers around the ill-defined set of objects of a general indexed category shall take us down some technical digressions for a bit, before we return to our big picture ideas. (Please keep in mind, the finer technicalities or nuances of this section mostly do not matter for a big picture understanding. The main part of this document where these details matter is in making rigorous our eventual discussion of geminal categories.)

\begin{definition}\label{StrictCategoryDefn}
Specifically, let us say a \defined{strict category} is a set of objects (including the ability to speak about equality of objects in a potentially finer-grained sense than isomorphism) and a set of morphisms, with the usual operations and satisfying the usual equations.\footnote{In certain contexts where quotient sets are not available, it is sometimes useful to allow strict categories to also come with a sort for 2-cell isomorphisms between their objects; that is, to take the collection of morphisms between any two objects in a strict category to comprise a setoid rather than a set. That is the more flexible and in some sense morally superior definition, but we will not need its extra complexity for now.} We may also speak of a \defined{strict functor}, meaning a homomorphism of such structure that preserves all of it on-the-nose, and so on for every other categorical notion. Strict categories and the strict functors between them comprise the 1-category $\StrictCat$.
\end{definition}

Every strict category [or functor or etc], gives rise to a category [or functor or etc] in whatever ordinary sense one would like to think of these. (In this way, we can also talk about functors or equivalences between strict categories and categories, by interpreting the strict categories as the categories simpliciter that they present). And conversely, one would ordinarily say every category is equivalent to \emph{some} strict category.\footnote{The situation is more nuanced for turning functors between arbitrary categories equivalent to given strict categories into strict functors between the given strict categories, but that will not concern us for now.} One might, if one likes, say that the only distinction between categories and strict categories is that we gather categories up into a 2-category and speak of categories up to equivalence in such, while we gather strict categories up into a 1-category and speak of strict categories up to isomorphism in such.

\begin{definition}
We now go further in defining a \defined{strict lexcategory}. Here, we mean more than just a strict category for which finite limits exist. We also mean that, when taking special \quote{basic limits}, the relevant limit is not merely defined up to isomorphism, but is given as a particular object (in keeping with the fact that objects can be distinguished more finely-grained than isomorphism, within a strict category). A \defined{strict lexfunctor} is accordingly one which preserves these chosen basic limits not merely up to isomorphism, but on-the-nose. Strict lexcategories and the strict lexfunctors between them comprise the 1-category $\StrictLexCat$. In the same way, we can also speak of a \defined{strict category with finite products}, or any similar such categorical structure.
\end{definition}

This business of \defined{basic limits} will require more explanation, another technical subtlety. What I mean by this is like so: Consider for example the concept of a category with a terminal object. And now consider the concept of a category with a pair of terminal objects, a terminal object A and a terminal object B. Ordinarily, we would like to say these are equivalent concepts or equivalent theories. They give rise to equivalent 2-categories (of categories with terminal objects, functors taking terminal objects to terminal objects, and natural transformations between these). However, the concept of a strict category with a single chosen terminal object, and the concept of a strict category with two chosen terminal objects A and B, are not equivalent concepts. We can ask questions in the one case that we cannot in the other; for example, in the latter case, we can distinguish between those models in which A and B are equal objects and those models in which A and B are not equal objects. This is reflected also in these giving rise to non-equivalent categories of models (of strict categories with the designated terminal objects, and functors preserving designated terminal objects on the nose). So when we go strictify the concept of a category with a terminal object, we really must make a choice as to how we choose to designate the terminal object; once or multiply.

This issue was illustrated above was terminal objects, but arises again, perhaps even more perniciously, for categories with finite products or finite limits or the like. Here, we find that the essentially algebraic theory of \quote{A strict category with a chosen terminal object and a binary operation sending any pair of objects to a chosen product} is not precisely the same as the essentially algebraic theory of \quote{A strict category with an $n$-ary operation on objects assigning chosen $n$-ary products, for each finite $n$}. Or the essentially algebraic theory of \quote{A strict category with a chosen terminal object and chosen (binary) pullbacks} is not precisely the same as the essentially algebraic theory of \quote{A strict category with a chosen terminal object, chosen binary products, and chosen (binary) equalizers}, particularly when we ask for homomorphisms between such structures which preserve their operations on-the-nose.

So in general, when we wish to talk about the appropriate notion of \quote{strict lexcategory} (or \quote{strict category with finite products} or \quote{strict cartesian closed category} or any such thing), we must make some decision as how exactly to formalize this. We must make some choice of a basic stock of limit operations (or representing object operations more generally) of the desired sort, such that all the other desired limits (or representing objects more generally) can be constructed from these basic operations. Different choices will yield slightly different strict concepts, albeit equivalent for all non-strict purposes.

None of the results in this work are ever particularly sensitive to what choice of basic such operations we take. We shall simply suppose some such choice has been made whenever needed, and refer to its operations as our basic limits. For convenience, if ever it should matter, we can presume there are only finitely many basic limit operations involved in defining a strict lexcategory (or any such finitely axiomatizable thing). If the reader simply cannot be put at peace without us making a concrete choice, let us say a strict lexcategory is defined by having a chosen terminal object, a chosen binary product operator, and a chosen (binary) equalizer operator.

\begin{definition}
Of course, we can speak of \defined{indexed strict categories} now (or indexed strict lexcategories, indexed strict categories with finite products, etc), straightforwardly via \cref{IndexedStructuresDefn}, as the appropriate diagram of indexed sets and functions between them. And we can speak of such indexed strict categories as being \repsmall/, just in case their indexed sets of objects and of morphisms are both \repsmall/.
\end{definition}

\begin{definition}
We also say an indexed strict category is \defined{locally \repsmall/} if the map $\langle \dom, \cod \rangle$ from its set of morphisms to its set of pairs of objects has \repsmall/ fibers (in other words, though its set of objects may not be \repsmall/, everything that exists between any two particular objects is \repsmall/). Note that a \repsmall/ strict category is a fortiori locally \repsmall/, as expected, as the collection of morphisms between any particular pair of objects are given by an equalizer between sets already presumed \repsmall/ in a \repsmall/ strict category.
\end{definition}

\begin{definition}
We will now say an indexed category is \defined{\repsmall/} or \defined{locally \repsmall/}\footnote{We could have defined the notion of an indexed category being locally \repsmall/ in a direct way, instead of circuitously through considering an equivalent indexed strict category, as the difficulties with indexed categories not having a well-defined set of objects do not apply to the individual hom-sets of morphisms an indexed category. However, writing out the theory of maps between indexed categories whose fibers can be treated as indexed sets, and then re-proving such facts as that this property is preserved in the manner of \cref{RepSmallRightAdjointFibers}, seemed more time-consuming and further afield from our ultimate interests in these notes than simply giving the definition of \quote{locally \repsmall/} in this way.} if it is equivalent to some indexed strict category which is \repsmall/ or locally \repsmall/, respectively. Note that we do not demand that, as part of its structure, any particular such strict category is selected; merely, that it is possible to do so. However, we may use the terminology \defined{internal category}, to mean the selection of a specific \repsmall/ indexed strict category; similarly, an \defined{internal lexcategory} will mean the selection of a specific \repsmall/ indexed strict lexcategory (including chosen basic limits), and so on.
\end{definition}

We note without detailed proof (\TODOinline{Give or cite proofs}) some strictification results which will be useful to us later.

\begin{theorem}\label{StrictifyCategory}
Every category is equivalent to some strict category.
\end{theorem}

\begin{theorem}\label{StrictifyLexcategory}
Every lexcategory is equivalent to some strict lexcategory.
\end{theorem}
\begin{proof}
One way to see this is by first noting that, for a given category $C$ with finite limits, we first of all have that $C$ is equivalent to some strict category $C'$ by \cref{StrictifyCategory}. To further equip $C'$ as a strict lexcategory, we just need to make some choice of designated limits for each basic limit within $C'$. This is readily done using the Axiom of Choice. (In contexts without Choice, this theorem needs to be approached more carefully, with a more deliberate choice of $C'$ rather than an arbitrary one, but can still be carried out.)
\end{proof}

\begin{theorem}\label{StrictifyLexfunctor}
Given a strict lexcategory $D$, a lexcategory $C$, and a lexfunctor $f : C \to D$, there is some strict lexcategory $C'$ and strict lexfunctor $f' : C' \to D$ such that $f$ and $f'$ are equivalent within the slice 2-category $\Cat/D$.
\end{theorem}

\begin{theorem}\label{StrictifyIndexedCategory}
Any indexed category is equivalent to some indexed strict category.
\end{theorem}

\begin{theorem}\label{StrictifyIndexedLexcategory}
Any indexed lexcategory is equivalent to some indexed strict lexcategory.
\end{theorem}

\begin{theorem}\label{StrictifyInternalCategoryToInternalLexcategory}
Any internal category which has finite limits (qua indexed category) can be further equipped as an internal lexcategory.
\end{theorem}
\begin{proof}
Let the internal category $C$, internal to $T$, be given, and suppose its $t$-aspect has finite limits for each object $t$ of $T$. That is, the category whose objects are $\Hom(t, \Ob(t))$ and whose morphisms are $\Hom(t, \Mor(t))$, with suitable composition structure from the diagram internal to $T$ defining $C$, has finite limits.

Then in particular, for each basis finite limit shape, we can consider the case where $t$ is taken to be the set of diagrams of such shape within $C$ (for example, for binary products, we can consider $t = \Ob(C) \times \Ob(C)$, or for binary equalizers, we can consider $t$ taken to be the kernel pair (that is, pullback along itself) of $\langle \cod, \dom \rangle : \Mor(C) \to \Ob(C) \times \Ob(C)$). There will then be, within the $t$-aspect of $C$, a corresponding generic diagram of this shape, which will have some limit within $C$ as $C$ has finite limits. The selection of any particular such limit (that is, a particular value in $\Hom(t, \Ob(C))$ to serve as the apex of the limit cone, and particular further values in $\Hom(t, \Mor(C))$ to serve as the projection morphisms of the limit cone) gives us the morphisms within $T$ which serve as a limit-assigning operation on $C$ for this particular shape of basic limit. After making such a choice for each of the basic limit operations (of which we can presume there are only finitely many), we ultimately have equipped $C$ as an internal lexcategory.
\end{proof}
Note that it is NOT true that any indexed strict category which has finite limits (qua indexed category) can furthermore be equipped as an indexed strict lexcategory! The former has reindexing functors which need only preserve finite limits in a non-strict-sense, while the latter's chosen basic limits must be such that all reindexing functors preserve basic limits on-the-nose. So it is rather remarkable that we get this for free once our indexed strict category is furthermore repsmall.

\subsection{Self-indexing}
\begin{definition}
Note that, from any lexcategory $T$ (or even just a category with pullbacks), we obtain a $T$-indexed lexcategory by considering the functor $T/-$ which assigns to each object $t$ of $T$ the slice category $T/t$, and whose action on morphisms is given by pullback. We refer to this as the \defined{self-indexing} of $T$.
\end{definition}

Note in the above that our flexibility in considering an indexed category as a pseudofunctor into $\Cat$, rather than a strict functor into $\StrictCat$, pays off in letting us not worry about how to choose specific pullback slices in a strictly functorial way. \TODOinline{That said, we will actually eventually use the construction under which this is made strictly functorial, at one point internally in our proof of Lob's theorem, so perhaps we should write out that construction in these Preliminaries as well.}

The self-indexing $T/-$ of a lexcategory $T$ is not in general \repsmall/, nor even locally \repsmall/. Given two globally defined objects $A$ and $B$ of the self-indexed category, their corresponding hom-set $\Hom_{T/-}(A, B)$ amounts to the presheaf $\Hom_{T}(A \times -, B)$ on $T$, which is to say, the exponential $B^A$ within $\Psh{T}$. This indexed set is \repsmall/ just in case an exponential object $B^A$ already exists within $T$. This extends in the same way to non-globally-defined objects of the self-indexed category (considered as globally defined over some slice category of $T$ instead), and so the self-indexing of $T$ is locally \repsmall/ just in case $T$ is locally cartesian closed. Even if we do not have local cartesian closure in full, note that when $A = 1$, the exponential $B^A$ always is given by $B$ itself, so that hom-sets whose domain is $1$ are always \repsmall/ within the self-indexed category, with $\Hom_{T/-}(1, B)$ being the same as $B$ itself. In this way, the global sections presheaf upon the self-indexed category yields the canonical equivalence between the self-indexed category and the category of \repsmall/ sets.

\begin{definition}
In the same way, we can also speak of an \defined{indexed category with finite products}, and indeed, from any category with finite products $T$ (or even just a category with binary products), we obtain a $T$-indexed category with finite products by considering the functor $T//-$ which assigns to each object $t$ of $T$ the full subcategory of $T/t$ consisting of projection slices (slices given by the projection $: t \times s \to t$ for some object $s$ of $T$), and whose action on morphisms is again given by pullback. We refer to this as the \defined{simple self-indexing} of $T$. Note that $T//t$ can also be thought of as the Kleisli category for the $t \times -$ comonad; that is, the objects of $T//t$ are the same as the objects of $T$, while a morphism $: s_1 \to s_2$ in $T//t$ is the same as a morphism $: t \times s_1 \to s_2$ in $T$, with suitable composition structure.
\end{definition}

By analogous reasoning to before, the simple self-indexing $T//-$ of a category with finite products $T$ is locally \repsmall/ just in case $T$ is cartesian closed.

\subsection{Double or multiple indexing}
\TODOinline{Reader beware, this section is only needed for understanding some of the discussion at the beginning of the chapter on Geminal Categories. Apart from that, this section does not come up significantly. TODO: Emphasize the notion of multiply internal structures, the main thing this section is used to discuss.}

Suppose $T$ is some category and $C$ is some category indexed over $T$. What does it mean to speak of a $T$-indexed $C$-indexed structure? By this, I mean a $T$-indexed \quote{gadget}, where the notion of \quote{gadget} is \quote{$C$-indexed structure}. For example, we may consider a $T$-indexed ($C$-indexed set). That is, a $T$-indexed presheaf $P$ on $C$.

What this means is that, for every object $t$ in $T$ and every $t$-defined object $c$ in $C$, we have some corresponding set of $P$ (the $t$-defined $c$-defined elements of $P$), and we also have a coherent system of pullback maps between these: Along any map $f : s \to t$ in $T$, we can pull back a $t$-defined $c$-defined element of $P$ to an $s$-defined $c$-defined element of $P$ (where the latter $c$ is implicitly the pullback along $f$ of the former $c$). And for any fixed $t$, given a $t$-defined map $g : d \to c$ in $C$, we can pull back a $t$-defined $c$-defined element of $P$ along this to a $t$-defined $d$-defined element of $P$. Both of these systems of pullbacks are functorial, and they also interact with each other \quote{commutatively} in the sense that pulling back along a map $g$ in $C$ and then pulling back along a map $f$ in $T$ is the same as pulling back along the map $f$ in $T$ and then pulling back along the map $g$ in $C$ (where, again, the latter, $g$ is implicitly the pullback along $f$ of the former $g$).

This all amounts to saying that $P$ is in fact indexed over the Grothendieck construction corresponding to $C$. We shall say $P$ is $(T, C)$-indexed.

What about maps between such doubly-indexed sets? Well, this is the same as the notion we get again by thinking of these as in fact singly-indexed over the Grothendieck construction. A natural transformation in that context.

Now that we understand doubly-indexed sets and maps between them, we can also understand doubly-indexed structures in general. Including doubly-indexed strict categories, and everything about doubly-indexed categorical structures works in basically the same fashion.

This all extends in the same way to triple indexing and so on. Given a $(T, C)$-indexed category $D$, we we have that $D$ is indexed over the Grothendieck construction corresponding to $C$, and thus there is also a further category given by the Grothendieck construction corresponding to $D$. Structures indexed over this last construction, we may refer to as $(T, C, D)$-indexed. If we write $(T, C)$ for the Grothendieck construction corresponding to $C$, a $(T, C, D)$-category is the same as a $((T, C), D)$-indexed category, and also can be interpreted as a $(T, (C, D))$-category for a suitable $T$-indexed category $(C, D)$. This amounts to structures which can be reindexed across morphisms in $T$, or  morphisms in $C$, or morphisms in $D$, all in a coherent way.

\TODOinline{Discuss the concept of being $T$-\repsmall/ vs. $C$-\repsmall/ when $(T, C)$-indexed}

Note also that any structure singly-indexed over $T$ can automatically be thought of as doubly-indexed over $T$ and $C$, where the indexing over $C$ is trivial. This is basically by the fact that the Grothendieck construction for $T$ and $C$ comes with a projection functor to $T$, so that all $T$-indexed structures thus induce, via this functor, a $T$-and-$C$-indexed structure. Thus, we can readily speak of maps between $T$-indexed structures and $(T, C)$-indexed structures, by treating the former as implicitly $(T, C)$-indexed themselves.

Indeed, more generally in the multiply indexed context, any structure indexed over some prefix of a string of categories is automatically indexed over the full string of categories. And in the same way, this allows us to speak of maps between structures indexed by different strings of categories. This is the main reason for us to bring all this up, just so that we can speak of maps between structures at different levels of indexing.

(Keep in mind also that an honest-to-goodness actual structure, living in $\Set$, is like the zero-ary case of indexing; it's indexed by the empty string of categories $()$, but can be seen in a trivial way as $T$-indexed for any category $T$).

Note that a map from a $T$-indexed structure $A$ to a $(T, C)$-indexed structure $B$ thus amounts to a map from $A$ to $\Hom_C(1, B)$, whenever $C$ has a terminal object. So all this high-faluting multiply indexed stuff just amounts to another way of thinking about maps into global aspects.
